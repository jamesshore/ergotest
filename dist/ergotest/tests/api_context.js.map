{"version":3,"sources":["/Users/jshore/Documents/Projects/ergotest/src/ergotest/tests/api_context.ts"],"sourcesContent":["// Copyright Titanium I.T. LLC. License granted under terms of \"The MIT License.\"\nimport * as ensure from \"../../util/ensure.js\";\nimport { TestMark, TestMarkValue } from \"../results/test_result.js\";\nimport { TestSuite } from \"./test_suite.js\";\nimport { FailureTestCase, TestCase } from \"./test_case.js\";\nimport { BeforeAfter } from \"./before_after.js\";\nimport { DescribeFn, DescribeOptions, ItFn, ItOptions, Milliseconds } from \"./test_api.js\";\nimport { Test } from \"./test.js\";\n\nexport class ApiContext {\n\tprivate readonly _context: TestSuiteBuilder[] = [];\n\n\tdescribe(\n\t\toptionalName: string | DescribeOptions | DescribeFn | undefined,\n\t\toptionalOptions: DescribeOptions | DescribeFn | undefined,\n\t\toptionalFn: DescribeFn | undefined,\n\t\tmark: TestMarkValue,\n\t) {\n\t\tconst DescribeOptionsType = { timeout: Number };\n\t\tensure.signature(arguments, [\n\t\t\t[ undefined, DescribeOptionsType, String, Function ],\n\t\t\t[ undefined, DescribeOptionsType, Function ],\n\t\t\t[ undefined, Function ],\n\t\t\tString,\n\t\t]);\n\t\tconst { name, options, fn } = decipherDescribeParameters(optionalName, optionalOptions, optionalFn);\n\t\tconst fullName = this.#fullName(name);\n\n\t\tconst suite = fn === undefined\n\t\t\t? createSkippedSuite(fullName, mark)\n\t\t\t: runDescribeBlock(this._context, fullName, mark, fn);\n\n\t\tif (this._context.length !== 0) this.#top.addSuite(suite);\n\t\treturn suite;\n\n\t\tfunction runDescribeBlock(context: TestSuiteBuilder[], fullName: string[], mark: TestMarkValue, fn: DescribeFn) {\n\t\t\tconst builder = new TestSuiteBuilder(fullName, mark, options.timeout);\n\t\t\tcontext.push(builder);\n\t\t\ttry {\n\t\t\t\tfn();\n\t\t\t}\n\t\t\tfinally {\n\t\t\t\tcontext.pop();\n\t\t\t}\n\t\t\treturn builder.toTestSuite();\n\t\t}\n\n\t\tfunction createSkippedSuite(name: string[], mark: TestMarkValue) {\n\t\t\tif (mark === TestMark.only) {\n\t\t\t\treturn TestSuite.create({\n\t\t\t\t\tname,\n\t\t\t\t\tmark,\n\t\t\t\t\ttests: [ new FailureTestCase(name, \"Test suite is marked '.only', but it has no body\") ],\n\t\t\t\t});\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn TestSuite.create({\n\t\t\t\t\tname,\n\t\t\t\t\tmark: TestMark.skip,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tit(\n\t\tname: string,\n\t\toptionalOptions: ItOptions | ItFn | undefined,\n\t\tpossibleFnAsync: ItFn | undefined,\n\t\tmark: TestMarkValue\n\t) {\n\t\tthis.#ensureInsideDescribe(\"it\");\n\t\tconst { options, fnAsync } = decipherItParameters(name, optionalOptions, possibleFnAsync);\n\t\tif (name === \"\") name = \"(unnamed)\";\n\n\t\tthis.#top.it(this.#fullName(name), mark, options, fnAsync);\n\t}\n\n\tbeforeAll(optionalOptions: ItOptions | ItFn, possibleFnAsync?: ItFn) {\n\t\tthis.#ensureInsideDescribe(\"beforeAll\");\n\t\tconst { options, fnAsync } = decipherBeforeAfterParameters(optionalOptions, possibleFnAsync);\n\n\t\tthis.#top.beforeAll(this.#fullName(), options, fnAsync);\n\t}\n\n\tafterAll(optionalOptions: ItOptions | ItFn, possibleFnAsync?: ItFn) {\n\t\tthis.#ensureInsideDescribe(\"afterAll\");\n\t\tconst { options, fnAsync } = decipherBeforeAfterParameters(optionalOptions, possibleFnAsync);\n\n\t\tthis.#top.afterAll(this.#fullName(), options, fnAsync);\n\t}\n\n\tbeforeEach(optionalOptions: ItOptions | ItFn, possibleFnAsync?: ItFn) {\n\t\tthis.#ensureInsideDescribe(\"beforeEach\");\n\t\tconst { options, fnAsync } = decipherBeforeAfterParameters(optionalOptions, possibleFnAsync);\n\n\t\tthis.#top.beforeEach(this.#fullName(), options, fnAsync);\n\t}\n\n\tafterEach(optionalOptions: ItOptions | ItFn, possibleFnAsync?: ItFn) {\n\t\tthis.#ensureInsideDescribe(\"afterEach\");\n\t\tconst { options, fnAsync } = decipherBeforeAfterParameters(optionalOptions, possibleFnAsync);\n\n\t\tthis.#top.afterEach(this.#fullName(), options, fnAsync);\n\t}\n\n\t#ensureInsideDescribe(functionName: string) {\n\t\tensure.that(this._context.length > 0, `${functionName}() must be run inside describe()`);\n\t}\n\n\tget #top() {\n\t\treturn this._context[this._context.length - 1];\n\t}\n\n\t#fullName(name = \"\") {\n\t\tconst topName = this._context.length === 0 ? [] : this.#top.name;\n\t\treturn name === \"\" ? topName : [ ...topName, name ];\n\t}\n\n}\n\nclass TestSuiteBuilder {\n\tprivate readonly _name: string[];\n\tprivate readonly _mark: TestMarkValue;\n\tprivate readonly _timeout?: Milliseconds;\n\tprivate readonly _tests: Test[] = [];\n\tprivate readonly _beforeAll: BeforeAfter[] = [];\n\tprivate readonly _afterAll: BeforeAfter[] = [];\n\tprivate readonly _beforeEach: BeforeAfter[] = [];\n\tprivate readonly _afterEach: BeforeAfter[] = [];\n\n\tconstructor(name: string[], mark: TestMarkValue, timeout?: Milliseconds) {\n\t\tthis._name = name;\n\t\tthis._mark = mark;\n\t\tthis._timeout = timeout;\n\t}\n\n\tpublic get name() {\n\t\treturn this._name;\n\t}\n\n\taddSuite(suite: TestSuite) {\n\t\tthis._tests.push(suite);\n\t}\n\n\tit(name: string[], mark: TestMarkValue, options: ItOptions, fnAsync?: ItFn) {\n\t\tthis._tests.push(TestCase.create({ name, mark, options, fnAsync }));\n\t}\n\n\tbeforeAll(parentName: string[], options: ItOptions, fnAsync: ItFn) {\n\t\tconst name = this.#beforeAfterName(parentName, this._beforeAll, \"beforeAll()\");\n\t\tthis._beforeAll.push(BeforeAfter.create({ name, options, fnAsync }));\n\t}\n\n\tafterAll(parentName: string[], options: ItOptions, fnAsync: ItFn) {\n\t\tconst name = this.#beforeAfterName(parentName, this._afterAll, \"afterAll()\");\n\t\tthis._afterAll.push(BeforeAfter.create({ name, options, fnAsync }));\n\t}\n\n\tbeforeEach(parentName: string[], options: ItOptions, fnAsync: ItFn) {\n\t\tconst name = this.#beforeAfterName(parentName, this._beforeEach, \"beforeEach()\");\n\t\tthis._beforeEach.push(BeforeAfter.create({ name, options, fnAsync }));\n\t}\n\n\tafterEach(parentName: string[], options: ItOptions, fnAsync: ItFn) {\n\t\tconst name = this.#beforeAfterName(parentName, this._afterEach, \"afterEach()\");\n\t\tthis._afterEach.push(BeforeAfter.create({ name, options, fnAsync }));\n\t}\n\n\ttoTestSuite(): TestSuite {\n\t\treturn TestSuite.create({\n\t\t\tname: this._name,\n\t\t\tmark: this._mark,\n\t\t\ttimeout: this._timeout,\n\t\t\tbeforeAll: this._beforeAll,\n\t\t\tafterAll: this._afterAll,\n\t\t\tbeforeEach: this._beforeEach,\n\t\t\tafterEach: this._afterEach,\n\t\t\ttests: this._tests,\n\t\t});\n\t}\n\n\t#beforeAfterName(parentName: string[], beforeAfterArray: BeforeAfter[], baseName: string) {\n\t\tconst number = beforeAfterArray.length === 0 ? \"\" : ` #${beforeAfterArray.length + 1}`;\n\t\treturn [ ...parentName, baseName + number];\n\t}\n}\n\nfunction decipherDescribeParameters(\n\tnameOrOptionsOrDescribeFn: string | DescribeOptions | DescribeFn | undefined,\n\toptionsOrDescribeFn: DescribeOptions | DescribeFn | undefined,\n\tpossibleDescribeFn: DescribeFn | undefined,\n) {\n\tlet name: string;\n\tlet options: DescribeOptions | undefined;\n\tlet fn: DescribeFn | undefined;\n\n\tswitch (typeof nameOrOptionsOrDescribeFn) {\n\t\tcase \"string\":\n\t\t\tname = nameOrOptionsOrDescribeFn;\n\t\t\tbreak;\n\t\tcase \"object\":\n\t\t\toptions = nameOrOptionsOrDescribeFn;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tfn = nameOrOptionsOrDescribeFn;\n\t\t\tbreak;\n\t\tcase \"undefined\":\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tensure.unreachable(`Unknown typeof for nameOrOptionsOrSuiteFn: ${typeof nameOrOptionsOrDescribeFn}`);\n\t}\n\tswitch (typeof optionsOrDescribeFn) {\n\t\tcase \"object\":\n\t\t\tensure.that(options === undefined, \"Received two options parameters\");\n\t\t\toptions = optionsOrDescribeFn;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tensure.that(fn === undefined, \"Received two suite function parameters\");\n\t\t\tfn = optionsOrDescribeFn;\n\t\t\tbreak;\n\t\tcase \"undefined\":\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tensure.unreachable(`Unknown typeof for optionsOrSuiteFn: ${typeof optionsOrDescribeFn}`);\n\t}\n\tif (possibleDescribeFn !== undefined) {\n\t\tensure.that(fn === undefined, \"Received two suite function parameters\");\n\t\tfn = possibleDescribeFn;\n\t}\n\n\tname ??= \"\";\n\toptions ??= {};\n\n\treturn { name, options, fn };\n}\n\nfunction decipherBeforeAfterParameters(optionalOptions: ItOptions | ItFn, possibleFnAsync?: ItFn) {\n\tensure.signature(arguments, [\n\t\t[ { timeout: Number }, Function ],\n\t\t[ undefined, Function ],\n\t]);\n\n\tlet options: ItOptions;\n\tlet fnAsync: ItFn;\n\n\tif (possibleFnAsync === undefined) {\n\t\toptions = {};\n\t\tfnAsync = optionalOptions as ItFn;\n\t}\n\telse {\n\t\toptions = optionalOptions as ItOptions;\n\t\tfnAsync = possibleFnAsync;\n\t}\n\n\treturn { options, fnAsync };\n}\n\nfunction decipherItParameters(\n\tname: string,\n\toptionsOrTestFn?: ItOptions | ItFn,\n\tpossibleTestFn?: ItFn,\n) {\n\tensure.signature(arguments, [\n\t\tString,\n\t\t[ undefined, { timeout: [ undefined, Number ]}, Function ],\n\t\t[ undefined, Function ],\n\t]);\n\n\tlet options = {};\n\tlet fnAsync;\n\n\tswitch (typeof optionsOrTestFn) {\n\t\tcase \"object\":\n\t\t\toptions = optionsOrTestFn;\n\t\t\tbreak;\n\t\tcase \"function\":\n\t\t\tfnAsync = optionsOrTestFn;\n\t\t\tbreak;\n\t\tcase \"undefined\":\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tensure.unreachable(`Unknown typeof optionsOrTestFn: ${typeof optionsOrTestFn}`);\n\t}\n\tif (possibleTestFn !== undefined) {\n\t\tensure.that(fnAsync === undefined, \"Received two test function parameters\");\n\t\tfnAsync = possibleTestFn;\n\t}\n\n\treturn { options, fnAsync };\n}\n\nconst testContext = new ApiContext();\n"],"names":["ensure","TestMark","TestSuite","FailureTestCase","TestCase","BeforeAfter","ApiContext","_context","describe","optionalName","optionalOptions","optionalFn","mark","DescribeOptionsType","timeout","Number","signature","arguments","undefined","String","Function","name","options","fn","decipherDescribeParameters","fullName","suite","createSkippedSuite","runDescribeBlock","length","addSuite","context","builder","TestSuiteBuilder","push","pop","toTestSuite","only","create","tests","skip","it","possibleFnAsync","fnAsync","decipherItParameters","beforeAll","decipherBeforeAfterParameters","afterAll","beforeEach","afterEach","functionName","that","topName","_name","_mark","_timeout","_tests","_beforeAll","_afterAll","_beforeEach","_afterEach","constructor","parentName","beforeAfterArray","baseName","number","nameOrOptionsOrDescribeFn","optionsOrDescribeFn","possibleDescribeFn","unreachable","optionsOrTestFn","possibleTestFn","testContext"],"mappings":"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"}