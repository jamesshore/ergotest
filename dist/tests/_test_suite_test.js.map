{"version":3,"sources":["/Users/jshore/Documents/Projects/ergotest/src/tests/_test_suite_test.ts"],"sourcesContent":["// Copyright Titanium I.T. LLC. License granted under terms of \"The MIT License.\"\n\nimport { test, assert } from \"../tests.js\";\nimport { TestMark, TestMarkValue, TestSuite } from \"./test_suite.js\";\nimport { Clock } from \"../infrastructure/clock.js\";\nimport { TestStatus, TestResult, TestCaseResult } from \"./test_result.js\";\nimport path from \"node:path\";\n// dependency: ./_module_passes.js\n// dependency: ./_module_throws.js\n// dependency: ./_module_no_export.js\n\n// Tests for my test library. (How meta.)\n\nconst SUCCESS_MODULE_PATH = path.resolve(import.meta.dirname, \"./_module_passes.js\");\nconst IRRELEVANT_NAME = \"irrelevant name\";\nconst DEFAULT_TIMEOUT = TestSuite.DEFAULT_TIMEOUT_IN_MS;\nconst EXCEED_TIMEOUT = DEFAULT_TIMEOUT + 1;\n\nexport default test(({ describe }) => {\n\n\tdescribe(\"test modules\", ({ it }) => {\n\n\t\tit(\"creates test suite from a module (and sets filename on result)\", async () => {\n\t\t\tconst suite = await TestSuite.fromModulesAsync([ SUCCESS_MODULE_PATH, SUCCESS_MODULE_PATH ]);\n\n\t\t\tconst testCaseResult = TestResult.pass(\"passes\", SUCCESS_MODULE_PATH);\n\t\t\tassert.objEqual(await suite.runAsync(),\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.suite([], [ testCaseResult ], SUCCESS_MODULE_PATH),\n\t\t\t\t\tTestResult.suite([], [ testCaseResult ], SUCCESS_MODULE_PATH),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t\tit(\"fails gracefully if module fails to require()\", async () => {\n\t\t\tconst suite = await TestSuite.fromModulesAsync([ \"./_module_throws.js\" ]);\n\t\t\tconst result = (await suite.runAsync()).allTests()[0];\n\n\t\t\tassert.deepEqual(result.name, [ \"error when requiring _module_throws.js\" ]);\n\t\t\tassert.equal(result.filename, \"./_module_throws.js\");\n\t\t\tassert.equal(result.status, TestStatus.fail);\n\t\t\tassert.match((result.error as { message: string }).message, /my require error/);\n\t\t});\n\n\t\tit(\"fails gracefully if module doesn't export a test suite\", async () => {\n\t\t\tconst suite = await TestSuite.fromModulesAsync([ \"./_module_no_export.js\" ]);\n\t\t\tconst result = (await suite.runAsync()).allTests()[0];\n\n\t\t\tassert.deepEqual(result.name, [ \"error when requiring _module_no_export.js\" ]);\n\t\t\tassert.equal(result.filename, \"./_module_no_export.js\");\n\t\t\tassert.equal(result.status, TestStatus.fail);\n\t\t\tassert.equal(result.error, \"doesn't export a test suite: ./_module_no_export.js\");\n\t\t});\n\n\t});\n\n\n\tdescribe(\"test suites\", ({ it }) => {\n\n\t\tit(\"executes immediately (but tests don't)\", () => {\n\t\t\tlet suiteRan = false;\n\t\t\tlet testRan = false;\n\t\t\tTestSuite.create(IRRELEVANT_NAME, ({ it }) => {\n\t\t\t\tsuiteRan = true;\n\t\t\t\tit(IRRELEVANT_NAME, () => {\n\t\t\t\t\ttestRan = true;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.equal(suiteRan, true, \"should run suite\");\n\t\t\tassert.equal(testRan, false, \"should not run test\");\n\t\t});\n\n\t\tit(\"returns test results when run\", async () => {\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit(\"test 1\", () => {});\n\t\t\t\tit(\"test 2\", () => {});\n\t\t\t\tit(\"test 3\", () => {});\n\t\t\t});\n\n\t\t\tconst result = await suite.runAsync();\n\t\t\tassert.objEqual(result,\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.pass(\"test 1\"),\n\t\t\t\t\tTestResult.pass(\"test 2\"),\n\t\t\t\t\tTestResult.pass(\"test 3\"),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t\tit(\"can be nested\", async () => {\n\t\t\tconst top = TestSuite.create(\"top\", ({ describe }) => {\n\t\t\t\tdescribe(\"middle\", ({ describe }) => {\n\t\t\t\t\tdescribe(\"bottom\", ({ it }) => {\n\t\t\t\t\t\tit(\"my test\", () => {});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst result = await top.runAsync();\n\t\t\tassert.objEqual(result,\n\t\t\t\tTestResult.suite(\"top\", [\n\t\t\t\t\tTestResult.suite([ \"top\", \"middle\" ], [\n\t\t\t\t\t\tTestResult.suite([ \"top\", \"middle\", \"bottom\" ], [\n\t\t\t\t\t\t\tTestResult.pass([ \"top\", \"middle\", \"bottom\", \"my test\" ]),\n\t\t\t\t\t\t]),\n\t\t\t\t\t]),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t\tit(\"propagates filename into children's test results\", async () => {\n\t\t\tconst clock = Clock.createNull();\n\t\t\tconst filename = \"my_filename\";\n\n\t\t\tconst suite = TestSuite.create(({ describe, it }) => {\n\t\t\t\tit(\"pass\", () => {});\n\t\t\t\tit.skip(\"skip\", () => {});\n\t\t\t\tit(\"fail\", () => { throw Error(\"fail\"); });\n\t\t\t\tit(\"timeout\", async () => { await clock.waitAsync(EXCEED_TIMEOUT); });\n\t\t\t\tit(\"test without body\");\n\t\t\t\tdescribe(\"suite without body\");\n\t\t\t});\n\t\t\tsuite._setFilename(filename);\n\n\t\t\tconst actualPromise = suite.runAsync({ clock });\n\t\t\tclock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.deepEqual(await actualPromise, TestResult.suite([], [\n\t\t\t\tcreatePass({ name: \"pass\", filename }),\n\t\t\t\tcreateSkip({ name: \"skip\", mark: TestMark.skip, filename }),\n\t\t\t\tcreateFail({ name: \"fail\", error: new Error(\"fail\"), filename }),\n\t\t\t\tcreateTimeout({ name: \"timeout\", timeout: DEFAULT_TIMEOUT, filename }),\n\t\t\t\tcreateSkip({ name: \"test without body\", mark: TestMark.skip, filename }),\n\t\t\t\tcreateSuite({ name: \"suite without body\", mark: TestMark.skip, filename }),\n\t\t\t], filename));\n\t\t});\n\n\t});\n\n\n\tdescribe(\"test cases\", ({ it }) => {\n\n\t\tit(\"runs when its parent suite is run\", async () => {\n\t\t\tlet testRan = false;\n\t\t\tconst suite = TestSuite.create(IRRELEVANT_NAME, ({ it }) => {\n\t\t\t\tit(IRRELEVANT_NAME, () => {\n\t\t\t\t\ttestRan = true;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.equal(testRan, false, \"before suite runs\");\n\t\t\tawait suite.runAsync();\n\t\t\tassert.equal(testRan, true, \"after suite runs\");\n\t\t});\n\n\t\tit(\"works with asynchronous code\", async () => {\n\t\t\tlet testRan = false;\n\t\t\tconst suite = TestSuite.create(IRRELEVANT_NAME, ({ it }) => {\n\t\t\t\tit(IRRELEVANT_NAME, async () => {\n\t\t\t\t\tawait new Promise<void>((resolve) => {\n\t\t\t\t\t\tsetImmediate(() => {\n\t\t\t\t\t\t\ttestRan = true;\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tawait suite.runAsync();\n\t\t\tassert.equal(testRan, true);\n\t\t});\n\n\t\tit(\"passes when test doesn't throw exception\", async () => {\n\t\t\tconst result = await runTestAsync(\"my test\", () => {});\n\t\t\tassert.objEqual(result, TestResult.pass(\"my test\"));\n\t\t});\n\n\t\tit(\"fails when test throws exception\", async () => {\n\t\t\tconst error = new Error(\"my error\");\n\t\t\tconst result = await runTestAsync(\"my test\", () => {\n\t\t\t\tthrow error;\n\t\t\t});\n\t\t\tassert.objEqual(result, TestResult.fail(\"my test\", error));\n\t\t});\n\n\t\tit(\"can retrieve config variables\", async () => {\n\t\t\tconst myConfig = { myConfig: \"my_config\" };\n\t\t\tlet receivedConfig;\n\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit(IRRELEVANT_NAME, ({ getConfig }) => {\n\t\t\t\t\treceivedConfig = getConfig(\"myConfig\");\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tawait suite.runAsync({ config: myConfig });\n\t\t\tassert.equal(receivedConfig, \"my_config\");\n\t\t});\n\n\t\tit(\"fails fast when no config defined\", async () => {\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit(IRRELEVANT_NAME, ({ getConfig }) => {\n\t\t\t\t\tgetConfig(\"no_such_config\");\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst results = await suite.runAsync({});\n\t\t\tassert.deepEqual(results, TestResult.suite([], [\n\t\t\t\tTestResult.fail(IRRELEVANT_NAME, new Error(\"No test config found for name 'no_such_config'\")),\n\t\t\t]));\n\t\t});\n\n\t\tit(\"fails fast when config defined, but config variable not found\", async () => {\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit(IRRELEVANT_NAME, ({ getConfig }) => {\n\t\t\t\t\tgetConfig(\"no_such_config\");\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst results = await suite.runAsync({ config: {} });\n\t\t\tassert.deepEqual(results, TestResult.suite([], [\n\t\t\t\tTestResult.fail(IRRELEVANT_NAME, new Error(\"No test config found for name 'no_such_config'\")),\n\t\t\t]));\n\t\t});\n\n\t});\n\n\n\tdescribe(\"naming\", ({ it }) => {\n\n\t\tit(\"test suites can be created with and without a name\", async () => {\n\t\t\tconst name = TestSuite.create(\"named\", ({ it }) => {\n\t\t\t\tit(\"has a name\", () => {});\n\t\t\t});\n\t\t\tconst noName = TestSuite.create(({ it }) => {\n\t\t\t\tit(\"has no name\", () => {});\n\t\t\t});\n\n\t\t\tassert.objEqual(await name.runAsync(), TestResult.suite(\"named\", [ TestResult.pass([ \"named\", \"has a name\" ]) ]));\n\t\t\tassert.objEqual(await noName.runAsync(), TestResult.suite([], [ TestResult.pass(\"has no name\") ]));\n\t\t});\n\n\t\tit(\"test cases without names are given a default\", async () => {\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit(\"\", () => {});\n\t\t\t});\n\n\t\t\tassert.objEqual(await suite.runAsync(), TestResult.suite([], [ TestResult.pass(\"(unnamed)\") ]));\n\t\t});\n\n\t\tit(\"sets name of test result to include nested suites\", async () => {\n\t\t\tconst top = TestSuite.create(\"top\", ({ describe }) => {\n\t\t\t\tdescribe(\"middle\", ({ describe }) => {\n\t\t\t\t\tdescribe(\"bottom\", ({ it }) => {\n\t\t\t\t\t\tit(\"my test\", () => {});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst result = await top.runAsync();\n\t\t\tassert.objEqual(result,\n\t\t\t\tTestResult.suite([ \"top\" ], [\n\t\t\t\t\tTestResult.suite([ \"top\", \"middle\" ], [\n\t\t\t\t\t\tTestResult.suite([ \"top\", \"middle\", \"bottom\" ], [\n\t\t\t\t\t\t\tTestResult.pass([ \"top\", \"middle\", \"bottom\", \"my test\" ]),\n\t\t\t\t\t\t]),\n\t\t\t\t\t]),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t\tit(\"collapses unnamed suites when setting test result name\", async () => {\n\t\t\tconst top = TestSuite.create(\"top\", ({ describe }) => {\n\t\t\t\tdescribe(\"\", ({ describe }) => {\n\t\t\t\t\tdescribe(\"\", ({ it }) => {\n\t\t\t\t\t\tit(\"my test\", () => {});\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst result = await top.runAsync();\n\t\t\tassert.objEqual(result,\n\t\t\t\tTestResult.suite(\"top\", [\n\t\t\t\t\tTestResult.suite(\"top\", [\n\t\t\t\t\t\tTestResult.suite(\"top\", [\n\t\t\t\t\t\t\tTestResult.pass([ \"top\", \"my test\" ]),\n\t\t\t\t\t\t]),\n\t\t\t\t\t]),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t});\n\n\n\tdescribe(\"before/after\", ({ it }) => {\n\n\t\tit(\"runs function before and after all tests in a suite\", async () => {\n\t\t\tconst ordering: string[] = [];\n\t\t\tconst pushFn: ((message: string) => () => void) = (message: string) => {\n\t\t\t\treturn () => ordering.push(message);\n\t\t\t};\n\n\t\t\tconst suite = TestSuite.create(IRRELEVANT_NAME, ({ beforeAll, afterAll, describe, it }) => {\n\t\t\t\tbeforeAll(pushFn(\"parent before 1\"));\n\t\t\t\tbeforeAll(pushFn(\"parent before 2\"));\n\t\t\t\tafterAll(pushFn(\"parent after 1\"));\n\t\t\t\tafterAll(pushFn(\"parent after 2\"));\n\t\t\t\tit(IRRELEVANT_NAME, pushFn(\"test 1\"));\n\t\t\t\tit(IRRELEVANT_NAME, pushFn(\"test 2\"));\n\t\t\t\tdescribe(IRRELEVANT_NAME, ({ beforeAll, afterAll, it }) => {\n\t\t\t\t\tbeforeAll(pushFn(\"child before\"));\n\t\t\t\t\tafterAll(pushFn(\"child after\"));\n\t\t\t\t\tit(IRRELEVANT_NAME, pushFn(\"test 3\"));\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tawait suite.runAsync();\n\t\t\tassert.deepEqual(ordering, [\n\t\t\t\t\"parent before 1\",\n\t\t\t\t\"parent before 2\",\n\t\t\t\t\"test 1\",\n\t\t\t\t\"test 2\",\n\t\t\t\t\"child before\",\n\t\t\t\t\"test 3\",\n\t\t\t\t\"child after\",\n\t\t\t\t\"parent after 1\",\n\t\t\t\t\"parent after 2\",\n\t\t\t]);\n\t\t});\n\n\t\tit(\"runs function before and after each test in a suite\", async () => {\n\t\t\tconst ordering: string[] = [];\n\t\t\tconst pushFn: ((message: string) => () => void) = (message) => {\n\t\t\t\treturn () => ordering.push(message);\n\t\t\t};\n\n\t\t\tconst suite = TestSuite.create(IRRELEVANT_NAME, ({ beforeEach, afterEach, describe, it }) => {\n\t\t\t\tbeforeEach(pushFn(\"parent before 1\"));\n\t\t\t\tbeforeEach(pushFn(\"parent before 2\"));\n\t\t\t\tafterEach(pushFn(\"parent after 1\"));\n\t\t\t\tafterEach(pushFn(\"parent after 2\"));\n\t\t\t\tit(IRRELEVANT_NAME, pushFn(\"test 1\"));\n\t\t\t\tit(IRRELEVANT_NAME, pushFn(\"test 2\"));\n\t\t\t\tdescribe(IRRELEVANT_NAME, ({ beforeEach, afterEach, it }) => {\n\t\t\t\t\tbeforeEach(pushFn(\"child before\"));\n\t\t\t\t\tafterEach(pushFn(\"child after\"));\n\t\t\t\t\tit(IRRELEVANT_NAME, pushFn(\"test 3\"));\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tawait suite.runAsync();\n\t\t\tassert.deepEqual(ordering, [\n\t\t\t\t\"parent before 1\",\n\t\t\t\t\"parent before 2\",\n\t\t\t\t\"test 1\",\n\t\t\t\t\"parent after 1\",\n\t\t\t\t\"parent after 2\",\n\t\t\t\t\"parent before 1\",\n\t\t\t\t\"parent before 2\",\n\t\t\t\t\"test 2\",\n\t\t\t\t\"parent after 1\",\n\t\t\t\t\"parent after 2\",\n\t\t\t\t\"parent before 1\",\n\t\t\t\t\"parent before 2\",\n\t\t\t\t\"child before\",\n\t\t\t\t\"test 3\",\n\t\t\t\t\"child after\",\n\t\t\t\t\"parent after 1\",\n\t\t\t\t\"parent after 2\",\n\t\t\t]);\n\t\t});\n\n\t\tit(\"provides config\", async () => {\n\t\t\tconst myConfig = { myConfig: \"my_config\" };\n\t\t\tlet beforeAllReceived, beforeEachReceived, afterEachReceived, afterAllReceived;\n\n\t\t\tconst suite = TestSuite.create(IRRELEVANT_NAME, ({ beforeAll, beforeEach, afterEach, afterAll, it }) => {\n\t\t\t\tbeforeAll(({ getConfig }) => { beforeAllReceived = getConfig(\"myConfig\"); });\n\t\t\t\tbeforeEach(({ getConfig }) => { beforeEachReceived = getConfig(\"myConfig\"); });\n\t\t\t\tit(IRRELEVANT_NAME, () => {});\n\t\t\t\tafterEach(({ getConfig }) => { afterEachReceived = getConfig(\"myConfig\"); });\n\t\t\t\tafterAll(({ getConfig }) => { afterAllReceived = getConfig(\"myConfig\"); });\n\t\t\t});\n\n\t\t\tawait suite.runAsync({ config: myConfig });\n\n\t\t\tassert.equal(beforeAllReceived, \"my_config\", \"beforeAll\");\n\t\t\tassert.equal(beforeEachReceived, \"my_config\", \"beforeEach\");\n\t\t\tassert.equal(afterEachReceived, \"my_config\", \"afterEach\");\n\t\t\tassert.equal(afterAllReceived, \"my_config\", \"afterAll\");\n\t\t});\n\n\t\tit(\"doesn't run beforeAll and afterAll when all children are skipped\", async () => {\n\t\t\tlet beforeRan = false;\n\t\t\tlet afterRan = false;\n\t\t\tconst suite = TestSuite.create(\"my suite\", ({ it, beforeAll, afterAll }) => {\n\t\t\t\tbeforeAll(() => {\n\t\t\t\t\tbeforeRan = true;\n\t\t\t\t});\n\t\t\t\tafterAll(() => {\n\t\t\t\t\tafterRan = true;\n\t\t\t\t});\n\t\t\t\tit.skip(\"test 1\", async () => {});\n\t\t\t\tit.skip(\"test 2\", async () => {});\n\t\t\t});\n\n\t\t\tawait suite.runAsync();\n\t\t\tassert.equal(beforeRan, false, \"shouldn't run beforeAll()\");\n\t\t\tassert.equal(afterRan, false, \"shouldn't run afterAll()\");\n\t\t});\n\n\t\tit(\"doesn't run beforeEach and afterEach when the test is skipped\", async () => {\n\t\t\tlet beforeRan = false;\n\t\t\tlet afterRan = false;\n\t\t\tconst suite = TestSuite.create(\"my suite\", ({ it, beforeEach, afterEach }) => {\n\t\t\t\tbeforeEach(() => {\n\t\t\t\t\tbeforeRan = true;\n\t\t\t\t});\n\t\t\t\tafterEach(() => {\n\t\t\t\t\tafterRan = true;\n\t\t\t\t});\n\t\t\t\tit.skip(\"test 1\", async () => {});\n\t\t\t});\n\n\t\t\tawait suite.runAsync();\n\t\t\tassert.equal(beforeRan, false, \"shouldn't run beforeEach()\");\n\t\t\tassert.equal(afterRan, false, \"shouldn't run afterEach()\");\n\t\t});\n\n\t\tit(\"handles exception in beforeAll\", async () => {\n\t\t\tconst error = new Error(\"my error\");\n\t\t\tconst suite = TestSuite.create(\"my suite\", ({ it, beforeAll }) => {\n\t\t\t\tbeforeAll(() => {\n\t\t\t\t\tthrow error;\n\t\t\t\t});\n\t\t\t\tit(\"test 1\", async () => {});\n\t\t\t\tit(\"test 2\", async () => {});\n\t\t\t});\n\n\t\t\tassert.objEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ name: \"my suite\", children: [\n\t\t\t\t\tcreateFail({ name: [ \"my suite\", \"beforeAll()\" ], error }),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"handles exception in afterAll\", async () => {\n\t\t\tconst error = new Error(\"my error\");\n\t\t\tconst suite = TestSuite.create(\"my suite\", ({ it, afterAll }) => {\n\t\t\t\tafterAll(() => {\n\t\t\t\t\tthrow error;\n\t\t\t\t});\n\t\t\t\tit(\"test 1\", async () => {});\n\t\t\t\tit(\"test 2\", async () => {});\n\t\t\t});\n\n\t\t\tassert.objEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ name: \"my suite\", children: [\n\t\t\t\t\tcreatePass({ name: [ \"my suite\", \"test 1\" ]}),\n\t\t\t\t\tcreatePass({ name: [ \"my suite\", \"test 2\" ]}),\n\t\t\t\t\tcreateFail({ name: [ \"my suite\", \"afterAll()\" ], error }),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"handles exception in beforeEach\", async () => {\n\t\t\tconst error = new Error(\"my error\");\n\t\t\tconst suite = TestSuite.create(({ it, beforeEach }) => {\n\t\t\t\tbeforeEach(() => {\n\t\t\t\t\tthrow error;\n\t\t\t\t});\n\t\t\t\tit(\"test 1\", async () => {});\n\t\t\t\tit(\"test 2\", async () => {});\n\t\t\t});\n\n\t\t\tassert.objEqual(await suite.runAsync(),\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.fail(\"test 1\", error),\n\t\t\t\t\tTestResult.fail(\"test 2\", error),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t\tit(\"doesn't run test when beforeEach throws exception\", async () => {\n\t\t\tlet testRan = false;\n\t\t\tconst suite = TestSuite.create(\"my suite\", ({ it, beforeEach }) => {\n\t\t\t\tbeforeEach(() => {\n\t\t\t\t\tthrow new Error();\n\t\t\t\t});\n\t\t\t\tit(\"my test\", () => {\n\t\t\t\t\ttestRan = true;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tawait suite.runAsync();\n\t\t\tassert.equal(testRan, false);\n\t\t});\n\n\t\tit(\"handles exception in afterEach\", async () => {\n\t\t\tconst error = new Error(\"my error\");\n\t\t\tconst suite = TestSuite.create(({ it, afterEach }) => {\n\t\t\t\tafterEach(() => {\n\t\t\t\t\tthrow error;\n\t\t\t\t});\n\t\t\t\tit(\"test 1\", () => {});\n\t\t\t\tit(\"test 2\", () => {});\n\t\t\t});\n\n\t\t\tassert.objEqual(await suite.runAsync(),\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.fail(\"test 1\", error),\n\t\t\t\t\tTestResult.fail(\"test 2\", error),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t\tit(\"runs afterEach() even when test throws exception\", async() => {\n\t\t\tlet afterEachRan = false;\n\t\t\tconst suite = TestSuite.create(\"my suite\", ({ it, afterEach }) => {\n\t\t\t\tafterEach(() => {\n\t\t\t\t\tafterEachRan = true;\n\t\t\t\t});\n\t\t\t\tit(\"my test\", () => {\n\t\t\t\t\tthrow new Error();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tawait suite.runAsync();\n\t\t\tassert.equal(afterEachRan, true);\n\t\t});\n\n\t\tit(\"only reports test exception when both test and afterEach throw exceptions\", async () => {\n\t\t\tconst afterEachError = new Error(\"afterEach error\");\n\t\t\tconst testError = new Error(\"test error\");\n\n\t\t\tconst suite = TestSuite.create(({ it, afterEach }) => {\n\t\t\t\tafterEach(() => {\n\t\t\t\t\tthrow afterEachError;\n\t\t\t\t});\n\t\t\t\tit(\"my test\", () => {\n\t\t\t\t\tthrow testError;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.objEqual(await suite.runAsync(),\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.fail(\"my test\", testError),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t});\n\n\n\tdescribe(\"timeouts\", ({ it }) => {\n\n\t\tit(\"times out when test doesn't complete in expected amount of time\", async () => {\n\t\t\tconst clock = Clock.createNull();\n\n\t\t\tlet beforeTime = null;\n\t\t\tlet afterTime = null;\n\t\t\tconst suite = TestSuite.create(({ it, beforeEach, afterEach }) => {\n\t\t\t\tbeforeEach(() => {\n\t\t\t\t\tbeforeTime = clock.now();\n\t\t\t\t});\n\t\t\t\tafterEach(() => {\n\t\t\t\t\tafterTime = clock.now();\n\t\t\t\t});\n\t\t\t\tit(\"my test\", async () => {\n\t\t\t\t\tawait clock.waitAsync(EXCEED_TIMEOUT);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst actualPromise = suite.runAsync({ clock });\n\t\t\tawait clock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.objEqual(await actualPromise,\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.timeout(\"my test\", DEFAULT_TIMEOUT)\n\t\t\t\t]),\n\t\t\t\t\"result\",\n\t\t\t);\n\t\t\tassert.equal(beforeTime, 0, \"beforeEach() should run immediately\");\n\t\t\tassert.equal(afterTime, DEFAULT_TIMEOUT, \"afterEach() should run as soon as it() times out\");\n\t\t});\n\n\t\tit(\"times out when beforeAll doesn't complete in expected amount of time\", async () => {\n\t\t\tconst clock = Clock.createNull();\n\n\t\t\tlet itTime = null;\n\t\t\tlet afterTime = null;\n\t\t\tconst suite = TestSuite.create(\"my suite\", ({ it, beforeAll, afterAll }) => {\n\t\t\t\tbeforeAll(async () => {\n\t\t\t\t\tawait clock.waitAsync(EXCEED_TIMEOUT);\n\t\t\t\t});\n\t\t\t\tafterAll(() => {\n\t\t\t\t\tafterTime = clock.now();\n\t\t\t\t});\n\t\t\t\tit(\"my test\", () => {\n\t\t\t\t\titTime = clock.now();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst actualPromise = suite.runAsync({ clock });\n\t\t\tawait clock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.objEqual(await actualPromise,\n\t\t\t\tTestResult.suite(\"my suite\", [\n\t\t\t\t\tTestResult.timeout([ \"my suite\", \"beforeAll()\" ], DEFAULT_TIMEOUT)\n\t\t\t\t]),\n\t\t\t\t\"result\",\n\t\t\t);\n\t\t\tassert.equal(itTime, null, \"it() should not run\");\n\t\t\tassert.equal(afterTime, null, \"afterAll() should not run\");\n\t\t});\n\n\t\tit(\"times out when afterAll doesn't complete in expected amount of time\", async () => {\n\t\t\tconst clock = Clock.createNull();\n\n\t\t\tlet beforeTime = null;\n\t\t\tlet itTime = null;\n\t\t\tconst suite = TestSuite.create(({ it, beforeAll, afterAll }) => {\n\t\t\t\tbeforeAll(() => {\n\t\t\t\t\tbeforeTime = clock.now();\n\t\t\t\t});\n\t\t\t\tafterAll(async () => {\n\t\t\t\t\tawait clock.waitAsync(EXCEED_TIMEOUT);\n\t\t\t\t});\n\t\t\t\tit(\"test 1\", () => {\n\t\t\t\t\titTime = clock.now();\n\t\t\t\t});\n\t\t\t\tit(\"test 2\", () => {});\n\t\t\t});\n\n\t\t\tconst actualPromise = suite.runAsync({ clock });\n\t\t\tawait clock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.objEqual(await actualPromise,\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.pass(\"test 1\"),\n\t\t\t\t\tTestResult.pass(\"test 2\"),\n\t\t\t\t\tTestResult.timeout(\"afterAll()\", DEFAULT_TIMEOUT),\n\t\t\t\t]),\n\t\t\t\t\"result\",\n\t\t\t);\n\t\t\tassert.equal(beforeTime, 0, \"beforeAll() should run immediately\");\n\t\t\tassert.equal(itTime, 0, \"it() should run immediately\");\n\t\t});\n\n\t\tit(\"times out when beforeEach doesn't complete in expected amount of time\", async () => {\n\t\t\tconst clock = Clock.createNull();\n\n\t\t\tlet itTime = null;\n\t\t\tlet afterTime = null;\n\t\t\tconst suite = TestSuite.create(({ it, beforeEach, afterEach }) => {\n\t\t\t\tbeforeEach(async () => {\n\t\t\t\t\tawait clock.waitAsync(EXCEED_TIMEOUT);\n\t\t\t\t});\n\t\t\t\tafterEach(() => {\n\t\t\t\t\tafterTime = clock.now();\n\t\t\t\t});\n\t\t\t\tit(\"my test\", () => {\n\t\t\t\t\titTime = clock.now();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst actualPromise = suite.runAsync({ clock });\n\t\t\tawait clock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.objEqual(await actualPromise,\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.timeout(\"my test\", DEFAULT_TIMEOUT)\n\t\t\t\t]),\n\t\t\t\t\"result\",\n\t\t\t);\n\t\t\tassert.equal(itTime, null, \"it() should not run\");\n\t\t\tassert.equal(afterTime, null, \"afterEach() should not run\");\n\t\t});\n\n\t\tit(\"times out when afterEach doesn't complete in expected amount of time\", async () => {\n\t\t\tconst clock = Clock.createNull();\n\n\t\t\tlet beforeTime = null;\n\t\t\tlet itTime = null;\n\t\t\tconst suite = TestSuite.create(({ it, beforeEach, afterEach }) => {\n\t\t\t\tbeforeEach(() => {\n\t\t\t\t\tbeforeTime = clock.now();\n\t\t\t\t});\n\t\t\t\tafterEach(async () => {\n\t\t\t\t\tawait clock.waitAsync(EXCEED_TIMEOUT);\n\t\t\t\t});\n\t\t\t\tit(\"my test\", () => {\n\t\t\t\t\titTime = clock.now();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst actualPromise = suite.runAsync({ clock });\n\t\t\tawait clock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.objEqual(await actualPromise,\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.timeout(\"my test\", DEFAULT_TIMEOUT)\n\t\t\t\t]),\n\t\t\t\t\"result\",\n\t\t\t);\n\t\t\tassert.equal(beforeTime, 0, \"beforeEach() should run immediately\");\n\t\t\tassert.equal(itTime, 0, \"it() should run immediately\");\n\t\t});\n\n\t\tit(\"times out each function separately\", async () => {\n\t\t\tconst clock = Clock.createNull();\n\t\t\tconst notQuiteTimeoutFn = async () => {\n\t\t\t\tawait clock.waitAsync(DEFAULT_TIMEOUT - 1);\n\t\t\t};\n\n\t\t\tconst suite = TestSuite.create(({ it, beforeAll, afterAll, beforeEach, afterEach }) => {\n\t\t\t\tbeforeAll(notQuiteTimeoutFn);\n\t\t\t\tbeforeAll(notQuiteTimeoutFn);\n\t\t\t\tafterAll(notQuiteTimeoutFn);\n\t\t\t\tafterAll(notQuiteTimeoutFn);\n\t\t\t\tbeforeEach(notQuiteTimeoutFn);\n\t\t\t\tbeforeEach(notQuiteTimeoutFn);\n\t\t\t\tafterEach(notQuiteTimeoutFn);\n\t\t\t\tafterEach(notQuiteTimeoutFn);\n\t\t\t\tit(\"test 1\", notQuiteTimeoutFn);\n\t\t\t\tit(\"test 2\", notQuiteTimeoutFn);\n\t\t\t});\n\n\t\t\tconst actualPromise = suite.runAsync({ clock });\n\t\t\tawait clock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.objEqual(await actualPromise,\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.pass(\"test 1\"),  // all tests pass because nothing timed out\n\t\t\t\t\tTestResult.pass(\"test 2\"),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t\tit(\"allows suites to configure timeout\", async () => {\n\t\t\tconst NEW_TIMEOUT = DEFAULT_TIMEOUT * 10;\n\n\t\t\tconst clock = Clock.createNull();\n\t\t\tconst notQuiteTimeoutFn = async () => {\n\t\t\t\tawait clock.waitAsync(NEW_TIMEOUT - 1);\n\t\t\t};\n\n\t\t\tconst suite = TestSuite.create(({\n\t\t\t\tit, setTimeout, beforeAll, afterAll, beforeEach, afterEach\n\t\t\t}) => {\n\t\t\t\tsetTimeout(NEW_TIMEOUT);\n\t\t\t\tbeforeAll(notQuiteTimeoutFn);\n\t\t\t\tafterAll(notQuiteTimeoutFn);\n\t\t\t\tbeforeEach(notQuiteTimeoutFn);\n\t\t\t\tafterEach(notQuiteTimeoutFn);\n\t\t\t\tit(\"my test\", notQuiteTimeoutFn);\n\t\t\t});\n\n\t\t\tconst actualPromise = suite.runAsync({ clock });\n\t\t\tawait clock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.objEqual(await actualPromise,\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.pass(\"my test\"),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t\tit(\"inherits parent's timeout\", async () => {\n\t\t\tconst NEW_TIMEOUT = DEFAULT_TIMEOUT * 10;\n\n\t\t\tconst clock = Clock.createNull();\n\t\t\tconst suite = TestSuite.create(({ describe, setTimeout }) => {\n\t\t\t\tsetTimeout(NEW_TIMEOUT);\n\t\t\t\tdescribe(({ it }) => {\n\t\t\t\t\tit(\"my test\", async () => {\n\t\t\t\t\t\tawait clock.waitAsync(NEW_TIMEOUT - 1);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst actualPromise = suite.runAsync({ clock });\n\t\t\tawait clock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.objEqual(await actualPromise,\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.suite([], [\n\t\t\t\t\t\tTestResult.pass(\"my test\"),\n\t\t\t\t\t]),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t});\n\n\n\tdescribe(\".skip\", ({ it }) => {\n\n\t\tit(\"skips and marks tests that have no function\", async () => {\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit(\"my test\");\n\t\t\t});\n\n\t\t\tconst result = (await suite.runAsync()).allTests()[0];\n\n\t\t\tassert.objEqual(result, createSkip({ name: \"my test\", mark: TestMark.skip }), \"should be skipped\");\n\t\t});\n\n\t\tit(\"skips and marks tests that have '.skip'\", async () => {\n\t\t\tlet testRan = false;\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit.skip(\"my test\", () => {\n\t\t\t\t\ttestRan = true;\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst result = (await suite.runAsync()).allTests()[0];\n\t\t\tassert.equal(testRan, false, \"should not run test\");\n\t\t\tassert.objEqual(result, createSkip({ name: \"my test\", mark: TestMark.skip }));\n\t\t\tassert.equal(result.mark, TestMark.skip, \"should be marked\");\n\t\t});\n\n\t\tit(\"skips suites that have no function\", async () => {\n\t\t\tconst suite = await TestSuite.create(\"my suite\").runAsync();\n\t\t\tconst noName = await TestSuite.create().runAsync();\n\n\t\t\tassert.objEqual(suite, createSuite({ name: \"my suite\", mark: TestMark.skip }));\n\t\t\tassert.objEqual(noName, createSuite({ name: [], mark: TestMark.skip }));\n\t\t});\n\n\t\tit(\"recursively skips everything within a suite that has '.skip'\", async () => {\n\t\t\tconst suite = TestSuite.create.skip(({ describe, it }) => {\n\t\t\t\tit(\"test 1\", () => {});\n\t\t\t\tit(\"test 2\", () => {});\n\t\t\t\tdescribe(({ it }) => {\n\t\t\t\t\tit(\"test 3\", () => {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tconst result = await suite.runAsync();\n\t\t\tassert.objEqual(result,\n\t\t\t\tcreateSuite({ mark: TestMark.skip, children: [\n\t\t\t\t\tTestResult.skip(\"test 1\"),\n\t\t\t\t\tTestResult.skip(\"test 2\"),\n\t\t\t\t\tTestResult.suite([], [\n\t\t\t\t\t\tTestResult.skip(\"test 3\"),\n\t\t\t\t\t]),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"doesn't mark skipped tests and suites that aren't explicitly marked '.skip'\", async () => {\n\t\t\tconst suite = TestSuite.create.skip(({ describe, it }) => {\n\t\t\t\tit(\"test\", () => {});\n\t\t\t\tdescribe(\"suite\", () => {});\n\t\t\t});\n\n\t\t\tconst result = await suite.runAsync();\n\t\t\tassert.objEqual(result,\n\t\t\t\tcreateSuite({ mark: TestMark.skip, children: [\n\t\t\t\t\tcreateSkip({ name: \"test\", mark: TestMark.none }),\n\t\t\t\t\tcreateSuite({ name: \"suite\", mark: TestMark.none }),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"generates failure when a suite is marked 'only' but has no body\", async () => {\n\t\t\tconst suite = TestSuite.create.only(\"my suite\");\n\n\t\t\tconst result = await suite.runAsync();\n\t\t\tassert.objEqual(result,\n\t\t\t\tcreateSuite({ name: \"my suite\", mark: TestMark.only, children: [\n\t\t\t\t\tcreateFail({ name: \"my suite\", error: \"Test suite is marked '.only', but it has no body\" }),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"generates failure when a test is marked 'only' but has no body\", async () => {\n\t\t\tconst suite = TestSuite.create(\"my suite\", ({ it }) => {\n\t\t\t\tit.only(\"my test\");\n\t\t\t});\n\n\t\t\tconst result = await suite.runAsync();\n\t\t\tassert.objEqual(result,\n\t\t\t\tcreateSuite({ name: \"my suite\", children: [\n\t\t\t\t\tcreateFail({\n\t\t\t\t\t\tname: [ \"my suite\", \"my test\" ],\n\t\t\t\t\t\terror: \"Test is marked '.only', but it has no body\",\n\t\t\t\t\t\tmark: TestMark.only,\n\t\t\t\t\t}),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t});\n\n\n\tdescribe(\".only\", ({ it }) => {\n\n\t\tit(\"if any tests are marked .only, it only runs those tests\", async () => {\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit.only(\".only\", () => {});\n\t\t\t\tit(\"not .only\", () => {});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ children: [\n\t\t\t\t\tcreatePass({ name: \".only\", mark: TestMark.only }),\n\t\t\t\t\tcreateSkip({ name: \"not .only\" }),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"marks test results as '.only'\", async () => {\n\t\t\tconst clock = Clock.createNull();\n\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit.only(\"pass\", () => {});\n\t\t\t\tit.only(\"fail\", () => { throw new Error(\"my error\"); });\n\t\t\t\tit.only(\"timeout\", async () => { await clock.waitAsync(EXCEED_TIMEOUT); });\n\t\t\t});\n\n\t\t\tconst resultPromise = suite.runAsync({ clock });\n\t\t\tclock.tickUntilTimersExpireAsync();\n\n\t\t\tassert.deepEqual(await resultPromise,\n\t\t\t\tcreateSuite({ children: [\n\t\t\t\t\tcreatePass({ name: \"pass\", mark: TestMark.only }),\n\t\t\t\t\tcreateFail({ name: \"fail\", error: new Error(\"my error\"), mark: TestMark.only }),\n\t\t\t\t\tcreateTimeout({ name: \"timeout\", timeout: DEFAULT_TIMEOUT, mark: TestMark.only }),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"if a suite is marked .only and none of its tests are, runs all of those tests\", async () => {\n\t\t\tconst suite = TestSuite.create(({ describe }) => {\n\t\t\t\tdescribe(\"not .only\", ({ it }) => {\n\t\t\t\t\tit(\"test1\", () => {});\n\t\t\t\t\tit(\"test2\", () => {});\n\t\t\t\t});\n\t\t\t\tdescribe.only(\".only\", ({ it }) => {\n\t\t\t\t\tit(\"test3\", () => {});\n\t\t\t\t\tit(\"test4\", () => {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tTestResult.suite([], [\n\t\t\t\t\tTestResult.suite(\"not .only\", [\n\t\t\t\t\t\tTestResult.skip([ \"not .only\", \"test1\" ]),\n\t\t\t\t\t\tTestResult.skip([ \"not .only\", \"test2\" ]),\n\t\t\t\t\t]),\n\t\t\t\t\tcreateSuite({ name: \".only\", mark: TestMark.only, children: [\n\t\t\t\t\t\tTestResult.pass([ \".only\", \"test3\" ]),\n\t\t\t\t\t\tTestResult.pass([ \".only\", \"test4\" ]),\n\t\t\t\t\t]}),\n\t\t\t\t]),\n\t\t\t);\n\t\t});\n\n\t\tit(\"if a suite is marked .only and none of its children are, run those tests recursively\", async () => {\n\t\t\tconst suite = TestSuite.create.only(({ describe }) => {\n\t\t\t\tdescribe(({ it }) => {\n\t\t\t\t\tit(\"test\", () => {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ mark: TestMark.only, children: [\n\t\t\t\t\tTestResult.suite([], [\n\t\t\t\t\t\tTestResult.pass(\"test\"),\n\t\t\t\t\t]),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"if a suite is marked .only and one of its children is also, only run that test\", async () => {\n\t\t\tconst suite = TestSuite.create.only(({ it }) => {\n\t\t\t\tit(\"not only\", () => {});\n\t\t\t\tit.only(\"only\", () => {});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ mark: TestMark.only, children: [\n\t\t\t\t\tcreateSkip({ name: \"not only\" }),\n\t\t\t\t\tcreatePass({ name: \"only\", mark: TestMark.only }),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"if a suite is marked .only and one of its grandchildren is also, only run that test\", async () => {\n\t\t\tconst suite = TestSuite.create.only(({ describe }) => {\n\t\t\t\tdescribe(({ it }) => {\n\t\t\t\t\tit(\"not only\", () => {});\n\t\t\t\t\tit.only(\"only\", () => {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ mark: TestMark.only, children: [\n\t\t\t\t\tcreateSuite({ children: [\n\t\t\t\t\t\tcreateSkip({ name: \"not only\" }),\n\t\t\t\t\t\tcreatePass({ name: \"only\", mark: TestMark.only }),\n\t\t\t\t\t]}),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"if a suite is marked .only and one of its child suites is also, only run that suite\", async () => {\n\t\t\tconst suite = TestSuite.create.only(({ describe }) => {\n\t\t\t\tdescribe(\"not only\", ({ it }) => {\n\t\t\t\t\tit(\"test1\", () => {});\n\t\t\t\t});\n\t\t\t\tdescribe.only(\"only\", ({ it }) => {\n\t\t\t\t\tit(\"test2\", () => {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ mark: TestMark.only, children: [\n\t\t\t\t\tTestResult.suite(\"not only\", [\n\t\t\t\t\t\tTestResult.skip([ \"not only\", \"test1\" ]),\n\t\t\t\t\t]),\n\t\t\t\t\tcreateSuite({ name: \"only\", mark: TestMark.only, children: [\n\t\t\t\t\t\tTestResult.pass([ \"only\", \"test2\" ]),\n\t\t\t\t\t]}),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"if a suite is marked .only and a child is marked .skip, skip the child\", async () => {\n\t\t\tconst suite = TestSuite.create.only(({ describe }) => {\n\t\t\t\tdescribe(({ it }) => {\n\t\t\t\t\tit.skip(\"test1\", () => {});\n\t\t\t\t\tit(\"test2\", () => {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ mark: TestMark.only, children: [\n\t\t\t\t\tcreateSuite({ children: [\n\t\t\t\t\t\tcreateSkip({ name: \"test1\", mark: TestMark.skip }),\n\t\t\t\t\t\tTestResult.pass(\"test2\"),\n\t\t\t\t\t]}),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"if a suite is marked .skip and a child is marked .only, run the child\", async () => {\n\t\t\tconst suite = TestSuite.create.skip(({ describe }) => {\n\t\t\t\tdescribe(({ it }) => {\n\t\t\t\t\tit.only(\"test1\", () => {});\n\t\t\t\t\tit(\"test2\", () => {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ mark: TestMark.skip, children: [\n\t\t\t\t\tcreateSuite({ children: [\n\t\t\t\t\t\tcreatePass({ name: \"test1\", mark: TestMark.only }),\n\t\t\t\t\t\tcreateSkip({ name: \"test2\" }),\n\t\t\t\t\t]}),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"if a suite is marked .only and a child suite is marked .skip, skip its children\", async () => {\n\t\t\tconst suite = TestSuite.create.only(({ describe }) => {\n\t\t\t\tdescribe.skip(({ it }) => {\n\t\t\t\t\tit(\"test1\", () => {});\n\t\t\t\t\tit(\"test2\", () => {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ mark: TestMark.only, children: [\n\t\t\t\t\tcreateSuite({ mark: TestMark.skip, children: [\n\t\t\t\t\t\tTestResult.skip(\"test1\"),\n\t\t\t\t\t\tTestResult.skip(\"test2\"),\n\t\t\t\t\t]}),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"if a suite is marked .skip and a child suite is marked .only, run its children\", async () => {\n\t\t\tconst suite = TestSuite.create.skip(({ describe }) => {\n\t\t\t\tdescribe.only(({ it }) => {\n\t\t\t\t\tit(\"test1\", () => {});\n\t\t\t\t\tit(\"test2\", () => {});\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tassert.deepEqual(await suite.runAsync(),\n\t\t\t\tcreateSuite({ mark: TestMark.skip, children: [\n\t\t\t\t\tcreateSuite({ mark: TestMark.only, children: [\n\t\t\t\t\t\tTestResult.pass(\"test1\"),\n\t\t\t\t\t\tTestResult.pass(\"test2\"),\n\t\t\t\t\t]}),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t\tit(\"marks suites even if they fail 'beforeAll'\", async () => {\n\t\t\tconst suite = TestSuite.create.only(\"my suite\", ({ beforeAll, it }) => {\n\t\t\t\tbeforeAll(() => { throw new Error(\"my error\"); });\n\t\t\t\tit(\"my test\");\n\t\t\t});\n\n\t\t\tconst result = await suite.runAsync();\n\t\t\tassert.objEqual(result,\n\t\t\t\tcreateSuite({ name: \"my suite\", mark: TestMark.only, children: [\n\t\t\t\t\tcreateFail({\n\t\t\t\t\t\tname: [ \"my suite\", \"beforeAll()\" ],\n\t\t\t\t\t\terror: new Error(\"my error\"),\n\t\t\t\t\t}),\n\t\t\t\t]}),\n\t\t\t);\n\t\t});\n\n\t});\n\n\n\tdescribe(\"notification\", ({ it }) => {\n\n\t\tit(\"runs notify function when test completes\", async () => {\n\t\t\tconst suite = TestSuite.create(({ it }) => {\n\t\t\t\tit(\"my test\", () => {});\n\t\t\t});\n\n\t\t\tlet testResult;\n\t\t\tfunction notifyFn(result: TestResult) {\n\t\t\t\ttestResult = result;\n\t\t\t}\n\n\t\t\tawait suite.runAsync({ notifyFn });\n\t\t\tassert.objEqual(testResult, TestResult.pass(\"my test\"));\n\t\t});\n\n\t\tit(\"runs notify function if module fails to require()\", async () => {\n\t\t\tconst suite = await TestSuite.fromModulesAsync([ \"./_module_throws.js\" ]);\n\n\t\t\tlet testResult: TestCaseResult;\n\t\t\tfunction notifyFn(result: TestCaseResult) {\n\t\t\t\ttestResult = result;\n\t\t\t}\n\n\t\t\tawait suite.runAsync({ notifyFn });\n\t\t\tassert.deepEqual(testResult!.name, [ \"error when requiring _module_throws.js\" ]);\n\t\t});\n\n\t\tit(\"runs notify function if module doesn't export a test suite\", async () => {\n\t\t\tconst suite = await TestSuite.fromModulesAsync([ \"./_module_no_export.js\" ]);\n\n\t\t\tlet testResult: TestCaseResult;\n\n\t\t\tfunction notifyFn(result: TestCaseResult) {\n\t\t\t\ttestResult = result;\n\t\t\t}\n\n\t\t\tawait suite.runAsync({ notifyFn });\n\t\t\tassert.deepEqual(testResult!.name, [ \"error when requiring _module_no_export.js\" ]);\n\t\t});\n\n\t});\n\n});\n\n\nasync function runTestAsync(testName: string, testFn: () => void) {\n\tconst suite = TestSuite.create(({ it }) => {\n\t\tit(testName, testFn);\n\t});\n\tconst result = await suite.runAsync();\n\treturn result.children[0];\n}\n\nfunction createSuite({\n\tname = [],\n\tchildren = [],\n\tfilename = undefined,\n\tmark = undefined,\n}: {\n\tname?: string | string[],\n\tchildren?: TestResult[],\n\tfilename?: string,\n\tmark?: TestMarkValue,\n} = {}) {\n\treturn TestResult.suite(name, children, filename, mark);\n}\n\nfunction createPass({\n\tname = \"irrelevant name\",\n\tfilename = undefined,\n\tmark = undefined,\n}: {\n\tname?: string | string[],\n\tfilename?: string,\n\tmark?: TestMarkValue,\n} = {}) {\n\treturn TestResult.pass(name, filename, mark);\n}\n\nfunction createFail({\n\tname = \"irrelevant name\",\n\terror = new Error(\"irrelevant error\"),\n\tfilename = undefined,\n\tmark = undefined,\n}: {\n\tname?: string | string[],\n\terror?: string | Error,\n\tfilename?: string,\n\tmark?: TestMarkValue,\n} = {}) {\n\treturn TestResult.fail(name, error, filename, mark);\n}\n\nfunction createSkip({\n\tname = \"irrelevant name\",\n\tfilename = undefined,\n\tmark = undefined,\n}: {\n\tname?: string | string[],\n\tfilename?: string,\n\tmark?: TestMarkValue,\n} = {}) {\n\treturn TestResult.skip(name, filename, mark);\n}\n\nfunction createTimeout({\n\tname = \"irrelevant name\",\n\ttimeout = 42,\n\tfilename = undefined,\n\tmark = undefined,\n}: {\n\tname?: string | string[],\n\ttimeout?: number,\n\tfilename?: string,\n\tmark?: TestMarkValue,\n} = {}) {\n\treturn TestResult.timeout(name, timeout, filename, mark);\n}"],"names":["test","assert","TestMark","TestSuite","Clock","TestStatus","TestResult","path","SUCCESS_MODULE_PATH","resolve","dirname","IRRELEVANT_NAME","DEFAULT_TIMEOUT","DEFAULT_TIMEOUT_IN_MS","EXCEED_TIMEOUT","describe","it","suite","fromModulesAsync","testCaseResult","pass","objEqual","runAsync","result","allTests","deepEqual","name","equal","filename","status","fail","match","error","message","suiteRan","testRan","create","top","clock","createNull","skip","Error","waitAsync","_setFilename","actualPromise","tickUntilTimersExpireAsync","createPass","createSkip","mark","createFail","createTimeout","timeout","createSuite","Promise","setImmediate","runTestAsync","myConfig","receivedConfig","getConfig","config","results","noName","ordering","pushFn","push","beforeAll","afterAll","beforeEach","afterEach","beforeAllReceived","beforeEachReceived","afterEachReceived","afterAllReceived","beforeRan","afterRan","children","afterEachRan","afterEachError","testError","beforeTime","afterTime","now","itTime","notQuiteTimeoutFn","NEW_TIMEOUT","setTimeout","none","only","resultPromise","testResult","notifyFn","testName","testFn","undefined"],"mappings":"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"}